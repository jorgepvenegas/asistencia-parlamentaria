---
interface Props {
  parties: Array<{
    id: string;
    name: string;
    color: string;
    slug: string;
  }>;
  selectedParty?: string;
}

const { parties, selectedParty } = Astro.props;
const selectedPartyName = parties.find((p) => p.id === selectedParty)?.name;
---

<div class="party-filter flex items-center gap-3">
  <label for="party-select" class="text-sm font-semibold text-gray-900">
    Filtrar por partido:
  </label>
  <select
    id="party-select"
    class="party-select px-3 py-2 border border-gray-300 rounded-lg text-sm"
  >
    <option value="">Todos los partidos</option>
    {
      parties.map((party) => (
        <option value={party.id} selected={selectedParty === party.id}>
          {party.name}
        </option>
      ))
    }
  </select>
</div>

<script>
  const select = document.querySelector<HTMLSelectElement>('.party-filter .party-select');
  if (select) {
    select.addEventListener('change', () => {
      const value = select.value;
      if (value) {
        const params = new URLSearchParams();
        params.set('party', value);
        window.location.href = `${window.location.pathname}?${params}`;
      } else {
        window.location.href = window.location.pathname;
      }
    });
  }
</script>
